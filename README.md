<p align="center">
  <img src="./assets/icons/tiny-drive_logo.svg" />
</p>

# **TinyDrive (Server)**

TinyDrive is a personal project, that is inspired by the Google's Drive interface and cloud storage. This project was developt to explore concepts and apply them is a somewhat real project.

TinyDrive was created for you store files on the cloud in a easy way and download or preview its content.

You can access the project and test it using this link: [Tiny Drive](https://tiny-drive.vercel.app/login)

if you don't want to login with your own email, you can use this login I've created for tests:

```
Email: tiny.test.drive@gmail.com
Senha: 12345678
```

# Main Features

-   **Standarized API Responses:** All the API endpoints will return an standarized response, making the API predictable. The models for the responses are created with pydantic models.
-   **File Preview:**
    -   The previews are generated in background, using FastAPI BackgroudTasks API, without blocking or slowing down the file upload response
    -   All previews are resized to fit in 1920x1080px, and converted into "JPEG" for opmization and to reduce the preview size even more.
    -   Previews are delivered by a signed-url generated by the storage provider (Supabase), which are cached in the browser using the HTTP `Cache-Control` header.
-   **File Deletetion:** To ensure reduce metadata and filedata atomicity, the files to be deleted are first stored in a trash path in the bucket and then removed.
-   **Authentication:** User authentication using the supabase authentication service. Authentication middleware validates the JWT token and verify for account mismatches between the token and the requested ownerid.
-   **BLOB Storage**: The files data are stored in the supabase storage service.
-   **Custom Exceptions Handling**: Use of custom exeptions that fit the domain.

# Run locally

This project uses mainly supabase for storage, authentication and database. If you want to run it you'll need a supabase project.

Clone this repo and move to the folder:

```bash
git clone https://github.com/RobertSDM/be-tiny-drive.git
cd be-tiny-drive
```

If you need run create a virtual environment:

```bash
python -m venv venv
```

Install the project dependencies in the requirements file

```bash
pip install -r requirements.txt
```

The necessary environment variables needed are:

-   `DATABASE_URL`
-   `SUPA_URL`
-   `SUPA_KEY`
-   `ORIGINS` # Origins allowed on CORS

Run with:

```bash
# if you already activated the venv
make run
# if you want to run and activate the venv
make env-run
```

# API Endpoints

The API was made with Fastapi, so it has a openAPI endpoint documenting the API. If you want to see more details about the API see the endpoint `/docs`"

# Technologies

## Frameworks

-   Fastapi

## Libraries

-   Alembic
-   Pillow
-   Pytest
-   SQLAlchemy
-   Supabase
-   Uvicorn
-   Zstandard

## Cloud

-   Supabase Storage
-   Supabase Authentication
-   Supabase Database - Postgres
-   Render (Server host)
